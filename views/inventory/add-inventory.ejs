<% if (title) { %>
  <h1><%= title %></h1>
<% } else {
  res.locals.title = "Add New Vehicle"
} %>

<%- messages() %>

<% if (errors) { %>
  <ul class="notice">
    <% errors.array().forEach(error => { %>
      <li><%= error.msg %></li>
    <% }) %>
  </ul>
<% } %>

<form id="addInventoryForm" action="/views/inventory/add-inventory.ejs" method="post">
  <fieldset>
    <legend>Vehicle Information</legend>
    
    <label for="classification">Classification:</label>
    <%- classificationList %>
    
    <label for="invMake">Make:</label>
    <input 
      type="text" 
      id="invMake" 
      name="inv_make" 
      required
      minlength="3"
      value="<%= locals.inv_make || '' %>"
    >
    
    <label for="invModel">Model:</label>
    <input 
      type="text" 
      id="invModel" 
      name="inv_model" 
      required
      minlength="3"
      value="<%= locals.inv_model || '' %>"
    >
    
    <label for="invYear">Year:</label>
    <input 
      type="text" 
      id="invYear" 
      name="inv_year" 
      required
      pattern="[0-9]{4}"
      maxlength="4"
      title="Please enter a 4-digit year"
      value="<%= locals.inv_year || '' %>"
    >
    
    <label for="invDescription">Description:</label>
    <textarea 
      id="invDescription" 
      name="inv_description" 
      required
      rows="4"
    ><%= locals.inv_description || '' %></textarea>
    
    <label for="invImage">Image Path:</label>
    <input 
      type="text" 
      id="invImage" 
      name="inv_image" 
      required
      value="<%= locals.inv_image || '/images/vehicles/no-image.png' %>"
    >
    
    <label for="invThumbnail">Thumbnail Path:</label>
    <input 
      type="text" 
      id="invThumbnail" 
      name="inv_thumbnail" 
      required
      value="<%= locals.inv_thumbnail || '/images/vehicles/no-image-tn.png' %>"
    >
    
    <label for="invPrice">Price:</label>
    <input 
      type="number" 
      id="invPrice" 
      name="inv_price" 
      required
      min="0"
      step="0.01"
      value="<%= locals.inv_price || '' %>"
    >
    
    <label for="invMiles">Miles:</label>
    <input 
      type="number" 
      id="invMiles" 
      name="inv_miles" 
      required
      min="0"
      value="<%= locals.inv_miles || '' %>"
    >
    
    <label for="invColor">Color:</label>
    <input 
      type="text" 
      id="invColor" 
      name="inv_color" 
      required
      value="<%= locals.inv_color || '' %>"
    >
    
    <button type="submit" class="submit-btn">Add Vehicle</button>
  </fieldset>
</form>

<script>
  document.getElementById('addInventoryForm').addEventListener('submit', function(e) {
    const year = document.getElementById('invYear').value;
    
    if (year.length !== 4 || isNaN(year)) {
      e.preventDefault();
      alert('Please enter a valid 4-digit year.');
      return false;
    }
  });
</script>